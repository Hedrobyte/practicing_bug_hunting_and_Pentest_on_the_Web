#!/bin/bash

######################################################################
# Script de Instalação de Ferramentas                                #
#                                                                    #
# Este script automatiza a instalação das ferramentas:               #
#   - findomain, amass, subfinder e assetfinder,                     #
#     github-subdomains, chaos, haktrails                            #
#                                                                    #
# Uso:                                                               #
#   - Execute este script como superusuário (sudo) para garantir     #
#     as permissões necessárias para instalação.                     #
#                                                                    #
# Autor: Pedro Henrique Maciel Alves                                 #
# Data de Criação: 13/10/23                                          #
# Update: 26/10/23                                                   #
#                                                                    #
######################################################################

# Função para instalar o findomain com tratamento de erro e mensagem informativa
install_findomain() {
    echo "Instalando findomain..."
    if curl -LO https://github.com/findomain/findomain/releases/latest/download/findomain-linux-i386.zip && \
        unzip findomain-linux-i386.zip && \
        chmod +x findomain && \
        mv findomain /usr/local/bin/findomain; then
        echo "findomain instalado com sucesso!"
        rm -f findomain-linux-i386.zip
    else
        echo "Erro ao instalar findomain!!!"
        exit 1
    fi
}

# Função para instalar as ferramentas Go com tratamento de erro e mensagem informativa
install_go_tools() {
    go_package="$1"
    echo ""
    echo "Instalando $go_package..."
    if sudo -u $SUDO_USER zsh -ic "go install $go_package@latest"; then
        echo "$go_package instalado com sucesso."
    else
        echo "Erro ao instalar $go_package."
        exit 1
    fi
}

# Verifica as permissões de superusuário
if [ "$EUID" -ne 0 ]; then
    echo "Este script requer permissões de superusuário."
    exit 1
fi


install_findomain
install_go_tools "github.com/owasp-amass/amass/v4/..."
install_go_tools "github.com/projectdiscovery/subfinder/v2/cmd/subfinder"
install_go_tools "github.com/tomnomnom/assetfinder"
install_go_tools "github.com/gwen001/github-subdomains"
install_go_tools "github.com/projectdiscovery/chaos-client/cmd/chaos"
install_go_tools "github.com/hakluke/haktrails" # Necessita de configurações adicionais, consulte a documentação.

