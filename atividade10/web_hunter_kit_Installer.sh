#!/bin/bash

######################################################################
# Script de Instalação de Ferramentas                                #
#                                                                    #
# Este script automatiza a instalação das ferramentas:               #
#   - findomain, amass, subfinder e assetfinder,                     #
#     github-subdomains, chaos, haktrails,                           #
#     dnsvalidator, shuffledns, massdns, dnsgen,                     #
#     altdns, dnsx, httpx, waybackurls, gau,                         #
#     cariddi, waymore, xnLinkFinder, anew,                          #
#     hakrawler, xnlinkfinder, hakcheckurl,                          #
#     nilo, urldedupe, gf, Gxss                                      #
# Uso:                                                               #
#   - Execute este script como superusuário (sudo) para garantir     #
#     as permissões necessárias para instalação.                     #
#                                                                    #
# Autor: Pedro Henrique Maciel Alves                                 #                                            #
#                                                                    #
######################################################################

# Verifica as permissões de superusuário
if [ "$EUID" -ne 0 ]; then
    echo "Este script requer permissões de superusuário."
    exit 1
fi

# Função para clonar e instalar ferramentas em repositório Git
clone_and_install() {
    echo ""
    echo "Clonando e instalando o repositório $1..."
    sudo -u $SUDO_USER git clone "$1" 
    
    repository_name=$(basename "$1" .git)
    cd "$repository_name"
    
    
    if [ -f setup.py ]; then
        python3 setup.py install 
    fi
    
    if [ -f Makefile ]; then
        sudo -u $SUDO_USER make 
        chmod +x ./bin/$repository_name &&
        mv ./bin/$repository_name /usr/local/bin/$repository_name
    fi
    
    cd ..
    rm -rf "$repository_name"
}

# Função para instalar as ferramentas Go 
install_go_tools() {
    go_package="$1"
    echo ""
    echo "Instalando $go_package..."
    if sudo -u $SUDO_USER zsh -ic "go install $go_package@latest"; then
        echo "$go_package instalado com sucesso."
    else
        echo "Erro ao instalar $go_package."
        exit 1
    fi
}

# Função para instalar o findomain 
install_findomain() {
  echo "Instalando findomain..."
  if {
    curl -LO https://github.com/findomain/findomain/releases/latest/download/findomain-linux-i386.zip &&
    unzip findomain-linux-i386.zip &&
    chmod +x findomain &&
    mv findomain /usr/local/bin/findomain
  }; then
    echo "findomain instalado com sucesso!"
    rm -f findomain-linux-i386.zip
  else
    echo "Erro ao instalar findomain!!!"
    exit 1
  fi
}


install_findomain
install_go_tools "github.com/owasp-amass/amass/v4/..."
install_go_tools "github.com/projectdiscovery/subfinder/v2/cmd/subfinder"
install_go_tools "github.com/tomnomnom/assetfinder"
install_go_tools "github.com/gwen001/github-subdomains"
install_go_tools "github.com/projectdiscovery/chaos-client/cmd/chaos" # Add key, consulte a documentação.
install_go_tools "github.com/hakluke/haktrails" # Add key, consulte a documentação.
install_go_tools "github.com/projectdiscovery/shuffledns/cmd/shuffledns"
install_go_tools "github.com/projectdiscovery/dnsx/cmd/dnsx"
install_go_tools "github.com/projectdiscovery/httpx/cmd/httpx"
install_go_tools "github.com/tomnomnom/waybackurls"
install_go_tools "github.com/lc/gau/v2/cmd/gau"
install_go_tools "github.com/edoardottt/cariddi/cmd/cariddi"
install_go_tools "github.com/tomnomnom/anew"
install_go_tools "github.com/hakluke/hakrawler"
install_go_tools "github.com/edoardottt/cariddi/cmd/cariddi"
install_go_tools "github.com/projectdiscovery/katana/cmd/katana"
install_go_tools "github.com/hakluke/hakcheckurl"
install_go_tools "github.com/tomnomnom/gf"
install_go_tools "github.com/KathanP19/Gxss"

clone_and_install "https://github.com/vortexau/dnsvalidator.git"
clone_and_install "https://github.com/blechschmidt/massdns.git"
clone_and_install "https://github.com/infosec-au/altdns.git"
clone_and_install "https://github.com/ProjectAnte/dnsgen.git"
clone_and_install "https://github.com/xnl-h4ck3r/waymore.git"
clone_and_install "https://github.com/xnl-h4ck3r/xnLinkFinder.git"
clone_and_install "https://github.com/xnl-h4ck3r/waymore.git"
clone_and_install "https://github.com/xnl-h4ck3r/xnLinkFinder.git"
clone_and_install "https://github.com/ferreiraklet/nilo.git"
clone_and_install "https://github.com/ameenmaali/urldedupe.git"

